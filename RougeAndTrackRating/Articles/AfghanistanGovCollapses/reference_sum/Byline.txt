The U.S. military raced to evacuate diplomats and civilians as the insurgents stood poised to retake complete control of the country 20 years after being toppled by American forces.